<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Doctor Appointments</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
  <style>
    body {
      background-color: #f8f9fa;
    }
    .token-input {
      width: 80px;
    }
  </style>
</head>
<body>
  <div class="d-flex">
    <nav class="bg-dark text-white p-3 vh-100" style="width: 250px;">
      <h4>ApkaDr.</h4>
      <ul class="nav flex-column mt-4">
        <li class="nav-item"><a class="nav-link text-white" href="doctor-dashboard.html">Dashboard</a></li>
        <li class="nav-item"><a class="nav-link text-white active" href="doctor-appointments.html">Appointments</a></li>
        <li class="nav-item"><a class="nav-link text-white" href="doctor-profile.html">My Profile</a></li>
        <li class="nav-item"><a class="nav-link text-white" href="doctor-login.html">Logout</a></li>
      </ul>
    </nav>

    <main class="p-4 w-100">
      <h2>Manage Appointments</h2>
      <table class="table table-bordered mt-4">
        <thead>
          <tr>
            <th>Patient Name</th>
            <th>Date</th>
            <th>Time</th>
            <th>Symptoms</th>
            <th>Status</th>
            <th>Token Number</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody id="appointmentsTableBody">
          <!-- Rows will be generated by JS -->
        </tbody>
      </table>
    </main>
  </div>

  <script>
    const appointments = [
      {
        id: 1,
        patientName: 'Adarsh Kumar',
        date: '2025-06-10',
        time: '10:30 AM',
        symptoms: 'Fever, headache',
        status: 'Pending',
        token: null,
      },
      {
        id: 2,
        patientName: 'Riya Singh',
        date: '2025-06-10',
        time: '11:00 AM',
        symptoms: 'Cough, cold',
        status: 'Confirmed',
        token: 12,
      },
      {
        id: 3,
        patientName: 'Aman Verma',
        date: '2025-06-11',
        time: '09:00 AM',
        symptoms: 'Back pain',
        status: 'Pending',
        token: null,
      }
    ];

    function renderAppointments() {
      const tbody = document.getElementById('appointmentsTableBody');
      tbody.innerHTML = '';
      appointments.forEach(appointment => {
        const tr = document.createElement('tr');

        tr.innerHTML = `
          <td>${appointment.patientName}</td>
          <td>${appointment.date}</td>
          <td>${appointment.time}</td>
          <td>${appointment.symptoms}</td>
          <td>
            ${appointment.status === 'Pending' ? 
              '<span class="badge bg-warning text-dark">Pending</span>' : 
              '<span class="badge bg-success">Confirmed</span>'}
          </td>
          <td>
            ${appointment.token !== null ? appointment.token : 
              (appointment.status === 'Confirmed' ? 'N/A' : '')}
          </td>
          <td>
            ${appointment.status === 'Pending' ? `
              <input type="number" min="1" placeholder="Token #" class="form-control form-control-sm token-input" id="tokenInput-${appointment.id}" />
              <button class="btn btn-success btn-sm mt-1" onclick="confirmAppointment(${appointment.id})">Confirm</button>
              <button class="btn btn-danger btn-sm mt-1" onclick="rejectAppointment(${appointment.id})">Reject</button>
            ` : `<button class="btn btn-secondary btn-sm" disabled>Confirmed</button>`}
          </td>
        `;
        tbody.appendChild(tr);
      });
    }

    function confirmAppointment(id) {
      const tokenInput = document.getElementById(`tokenInput-${id}`);
      const token = tokenInput.value.trim();

      if (!token || isNaN(token) || Number(token) <= 0) {
        alert('Please enter a valid token number (positive integer).');
        return;
      }

      const appointment = appointments.find(app => app.id === id);
      appointment.status = 'Confirmed';
      appointment.token = Number(token);
      renderAppointments();
      alert(`Appointment for ${appointment.patientName} confirmed with token #${token}.`);
    }

    function rejectAppointment(id) {
      if (!confirm('Are you sure you want to reject this appointment?')) return;
      const index = appointments.findIndex(app => app.id === id);
      if (index !== -1) {
        appointments.splice(index, 1);
        renderAppointments();
        alert('Appointment rejected and removed.');
      }
    }

    renderAppointments();
  </script>
</body>
</html>
